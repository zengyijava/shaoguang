<!doctype html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Cropper</title>
	<link rel="stylesheet" type="text/css" href="css/normalize.css" />
	<link rel="stylesheet" type="text/css" type="text/css" href="css/default.css" />
	<link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css" />
  	<link rel="stylesheet" type="text/css" href="dist/cropper.css" />
  	<link rel="stylesheet" type="text/css" href="css/main.css" />
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/bootstrap.min.js"></script>
	<script src="dist/cropper.js"></script>
	<script src="js/main.js"></script>
	<style>
	.docs-tooltip {
		padding: 1px 4px;
    }
	.docs-buttons > .btn, .docs-buttons > .btn-group, .docs-buttons > .form-control {
		margin-right: 0px;
		margin-bottom: 0px;
    }
	.img-container {
		margin-bottom: 5px;
	}
	#tttempImg{
	max-width:480px;
	width: 480px;
	}
	</style>
</head>
<body>
<div class="htmleaf-container">
		<!-- Content -->
  <div class="container">
    <div class="row">
      <div class="col-md-9">
<!--         <h3 class="page-header">原图:</h3>
 -->		
<h3 class="page-header"></h3>
		<div class="docs-cropped" style="display:hidden;">
		  <div class="modal-content" style="border:none; box-shadow:none;">
		    <div id="cropper-result" class="modal-body" style="padding:0;">
			</div>
		  </div>
		</div>
		
        <div id="original-position" class="img-container">
          <img id="tttempImg" src="" alt="Picture">
        </div>
		
      </div>
      <div class="col-md-3">
        <h3 class="page-header"></h3>
<!--         <h3 class="page-header">预览:</h3> -->
        <div class="docs-preview clearfix">
          <div class="img-preview preview-lg"></div>
          <!-- <div class="img-preview preview-md"></div>
          <div class="img-preview preview-sm"></div>
          <div class="img-preview preview-xs"></div> -->
        </div>

        <!-- <h3 class="page-header">Data:</h3> -->

      </div>
    </div>
    <div class="row">
      <div class="col-md-9 docs-buttons">
        <!-- <h3 class="page-header">Toolbar:</h3> -->
        <div class="btn-group" id="btn1">
          <button class="btn btn-primary" data-method="setDragMode" data-option="crop" type="button" title="Crop">
            <span class="docs-tooltip" data-toggle="tooltip" title="剪切">
              <span class="icon icon-crop"></span>
            </span>
          </button>
          <button class="btn btn-primary" data-method="zoom" data-option="0.1" type="button" title="Zoom In">
            <span class="docs-tooltip" data-toggle="tooltip" title="放大">
              <span class="icon icon-zoom-in"></span>
            </span>
          </button>
          <button class="btn btn-primary" data-method="zoom" data-option="-0.1" type="button" title="Zoom Out">
            <span class="docs-tooltip" data-toggle="tooltip" title="缩小">
              <span class="icon icon-zoom-out"></span>
            </span>
          </button>
          <button class="btn btn-primary" data-method="rotate" data-option="-45" type="button" title="Rotate Left">
            <span class="docs-tooltip" data-toggle="tooltip" title="左旋转45°">
              <span class="icon icon-rotate-left"></span>
            </span>
          </button>
          <button class="btn btn-primary" data-method="rotate" data-option="45" type="button" title="Rotate Right">
            <span class="docs-tooltip" data-toggle="tooltip" title="右旋转45°">
              <span class="icon icon-rotate-right"></span>
            </span>
          </button>
          <button class="btn btn-primary" data-method="clear" type="button" title="Clear">
            <span class="docs-tooltip" data-toggle="tooltip" title="清除">
              <span class="icon icon-remove"></span>
            </span>
          </button>
          <button class="btn btn-primary" data-method="reset" type="button" title="Reset">
            <span class="docs-tooltip" data-toggle="tooltip" title="重置">
              <span class="icon icon-refresh"></span>
            </span>
          </button>
          <!-- <label class="btn btn-primary btn-upload" for="inputImage" title="Upload image file">
            <input class="sr-only" id="inputImage" name="file" type="file" accept="image/*">
            <span class="docs-tooltip" data-toggle="tooltip" title="上传图片">
              <span class="icon icon-upload"></span>
            </span>
          </label> -->
        </div>
		
		<div class="btn-group" id="btn2">
          <button class="btn btn-primary" data-method="setAspectRatio" data-option="1.7777777777777777" title="Set Aspect Ratio">
            <span class="docs-tooltip" data-toggle="tooltip" title="$().cropper(&quot;setAspectRatio&quot;, 16 / 9)">16:9</span>
          </button>
		  <button class="btn btn-primary" data-method="setAspectRatio" data-option="1.3333333333333333" title="Set Aspect Ratio">
            <span class="docs-tooltip" data-toggle="tooltip" title="$().cropper(&quot;setAspectRatio&quot;, 4 / 3)">4:3</span>
          </button>
		  <button class="btn btn-primary" data-method="setAspectRatio" data-option="1" title="Set Aspect Ratio">
            <span class="docs-tooltip" data-toggle="tooltip" title="$().cropper(&quot;setAspectRatio&quot;, 1 / 1)">1:1</span>
          </button>
		  <button class="btn btn-primary" data-method="setAspectRatio" data-option="0.6666666666666666" title="Set Aspect Ratio">
            <span class="docs-tooltip" data-toggle="tooltip" title="$().cropper(&quot;setAspectRatio&quot;, 2 / 3)">2:3</span>
          </button>
		  <button class="btn btn-primary" data-method="setAspectRatio" data-option="NaN" title="Set Aspect Ratio">
            <span class="docs-tooltip" data-toggle="tooltip" title="$().cropper(&quot;setAspectRatio&quot;, NaN)">自由比例</span>
          </button>
		</div>
		
       <!--  <div class="btn-group" id="btn3" >
          <button class="btn btn-primary" data-method="getCroppedCanvas" type="button">
            <span class="docs-tooltip" data-toggle="tooltip" title="$().cropper(&quot;getCroppedCanvas&quot;)">完成</span>
          </button>
		</div> -->
		  
		<!-- <div class="btn-group" id="btn4" style="display:none;">  
		  <button onclick="toEdit();" class="btn btn-primary" type="button">
		  	 <span class="docs-tooltip">返回编辑</span>
		  </button>
        </div> -->

        <!-- Show the cropped image in modal -->
        <!-- <div class="modal fade docs-cropped" id="getCroppedCanvasModal" aria-hidden="true" aria-labelledby="getCroppedCanvasTitle" role="dialog" tabindex="-1">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button class="close" data-dismiss="modal" type="button" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="getCroppedCanvasTitle">Cropped</h4>
              </div>
              <div class="modal-body"></div>
              <div class="modal-footer">
                <button class="btn btn-primary" data-dismiss="modal" type="button">Close</button>
              </div>
            </div>
          </div>
        </div> --><!-- /.modal -->

      </div><!-- /.docs-buttons -->

    </div>
  </div>
</div>
<script>
	
	
	function getUrlParam(name) {
		var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
		var r = window.location.search.substr(1).match(reg); //匹配目标参数
		if (r != null)
			return unescape(r[2]);
		return null; //返回参数值
	}
	var pathName = window.location.pathname.substring(1);
	var webName = pathName == '' ? '' : pathName.substring(0, pathName.indexOf('/'));
	webName = '/' + webName + '/';
	var imgPath = getUrlParam("imgPath");
	if (0 != imgPath.indexOf('/')) {
		imgPath = webName + imgPath;
	}
	var $image = $('#tttempImg');
	document.getElementById("tttempImg").setAttribute("src", imgPath);

	var $dataX = $('#dataX'), $dataY = $('#dataY'), $dataHeight = $('#dataHeight'), $dataWidth = $('#dataWidth'), $dataRotate = $('#dataRotate'), options = {
		autoCrop : false,
		aspectRatio : NaN,
		preview : '.img-preview',
		crop : function(data) {
			$dataX.val(Math.round(data.x));
			$dataY.val(Math.round(data.y));
			$dataHeight.val(Math.round(data.height));
			$dataWidth.val(Math.round(data.width));
			$dataRotate.val(Math.round(data.rotate));
		}
	};

	$image.on({
		'build.cropper' : function(e) {
		},
		'built.cropper' : function(e) {
		},
		'dragstart.cropper' : function(e) {
		},
		'dragmove.cropper' : function(e) {
		},
		'dragend.cropper' : function(e) {
		},
		'zoomin.cropper' : function(e) {
		},
		'zoomout.cropper' : function(e) {
		}
	}).cropper(options);

	$(document.body).on('click', '[data-method]', function() {
		var data = $(this).data(), $target, result;

		if (data.method) {
			data = $.extend({}, data);
			if (typeof data.target !== 'undefined') {
				$target = $(data.target);

				if (typeof data.option === 'undefined') {
					try {
						data.option = JSON.parse($target.val());
					} catch (e) {
					}
				}
			}

			result = $image.cropper(data.method, data.option);

			if ($.isPlainObject(result) && $target) {
				try {
					$target.val(JSON.stringify(result));
				} catch (e) {
				}
			}

		}
	}).on('keydown', function(e) {

		switch (e.which) {
		case 37:
			e.preventDefault();
			$image.cropper('move', -1, 0);
			break;

		case 38:
			e.preventDefault();
			$image.cropper('move', 0, -1);
			break;

		case 39:
			e.preventDefault();
			$image.cropper('move', 1, 0);
			break;

		case 40:
			e.preventDefault();
			$image.cropper('move', 0, 1);
			break;
		}

	});

	var $inputImage = $('#inputImage'), URL = window.URL || window.webkitURL, blobURL;

	if (URL) {
		$inputImage.change(function() {
			var files = this.files, file;

			if (files && files.length) {
				file = files[0];

				if (/^image\/\w+$/.test(file.type)) {
					blobURL = URL.createObjectURL(file);
					$image.one('built.cropper', function() {
						URL.revokeObjectURL(blobURL); // Revoke when load complete
					}).cropper('reset', true).cropper('replace', blobURL);
					$inputImage.val('');
				} else {
				}
			}
		});
	} else {
		$inputImage.parent().remove();
	}

	// Options
	$('.docs-options :checkbox').on('change', function() {
		var $this = $(this);

		options[$this.val()] = $this.prop('checked');
		$image.cropper('destroy').cropper(options);
	});

	// Tooltips
	$('[data-toggle="tooltip"]').tooltip();

	function toEdit() {
		$('#btn1').css("visibility", "visible");
		$('#btn2').css("visibility", "visible");
		$('#btn3').show();
		$('#btn4').hide();
		$('#original-position').show();
		$('#cropper-result').hide();
	}
</script>
</body>
</html>